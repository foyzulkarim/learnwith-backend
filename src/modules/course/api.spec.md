# Course Management API Documentation

## Overview

This document outlines the RESTful API for managing courses, modules, and lessons using an embedded document structure in MongoDB.

## Data Structure

The database uses embedded documents where:
- Courses contain modules
- Modules contain lessons
- Each document type has a unique object ID generated by the mongodb server

## Authentication

All endpoints require proper authentication (not implemented in this documentation).

## API Endpoints

### Courses

#### Get All Courses

```
GET /api/courses

Response:
{
  "courses": [
    {
      "_id": string or objectId,
      "title": string,
      "description": string,
      "thumbnailUrl": string,
      "instructor": string,
      "category": string,
      "difficulty": string,
      "totalLessons": number,
      ... other course fields
    }
  ],
  "total": number,
  "page": number,
  "limit": number
}
```

#### Get Course by ID

```
GET /api/courses/:courseId

Response:
{
  "_id": string or objectId,
  "title": string,
  "description": string,
  "thumbnailUrl": string,
  "instructor": string,
  "instructorAvatar": string | null,
  "price": string | null,
  "rating": string | null,
  "category": string,
  "difficulty": string,
  "featured": boolean,
  "bestseller": boolean,
  "newCourse": boolean,
  "totalLessons": number,
  "totalDuration": string | null,
  "lastUpdated": string | null,
  "language": string,
  "captions": string[] | null,
  "studentCount": number,
  "completedLessons": number | null,
  "progress": number | null,
  "status": string | null,
  "publishedAt": string | null,
  "completionRate": number | null
}
```

#### Create Course

```
POST /api/courses

Payload:
{
  "title": string,
  "description": string,
  "thumbnailUrl": string,
  "instructor": string, 
  "instructorAvatar"?: string,
  "price"?: string,
  "category": string,
  "difficulty": string,
  "featured"?: boolean,
  "bestseller"?: boolean,
  "newCourse"?: boolean,
  "language"?: string
}

Response:
{
  "_id": string or objectId,  // MongoDB Server-generated ID
  "title": string,
  "description": string,
  ... all other fields with defaults
  "modules": []  // Empty modules array
}
```

#### Update Course

```
PUT /api/courses/:courseId

Payload:
{
  "title"?: string,
  "description"?: string, 
  "thumbnailUrl"?: string,
  "instructor"?: string,
  "instructorAvatar"?: string,
  "price"?: string,
  "category"?: string,
  "difficulty"?: string,
  "featured"?: boolean,
  "bestseller"?: boolean,
  "newCourse"?: boolean,
  "language"?: string
}

Response:
{
  "_id": string or objectId,
  ... updated course data
}
```

#### Delete Course

```
DELETE /api/courses/:courseId

Response:
{
  "success": true
}
```

### Curriculum Management

#### Get Course Curriculum

```
GET /api/courses/:courseId/curriculum

Response:
{
  "modules": [
    {
      "_id": string or objectId,
      "title": string,
      "order": number,
      "lessons": [
        {
          "_id": string or objectId,
          "title": string,
          "videoUrl": string,
          "content": string,
          "duration": string,
          "order": number
        }
      ]
    }
  ]
}
```

### Modules

#### Get Module

```
GET /api/courses/:courseId/modules/:moduleId

Response:
{
  "_id": string or objectId,
  "title": string,
  "order": number,
  "lessons": [
    {
      "_id": string or objectId,
      "title": string,
      "videoUrl": string,
      "content": string,
      "duration": string,
      "order": number
    }
  ]
}
```

#### Create Module

```
POST /api/courses/:courseId/modules

Payload:
{
  "title": string,
  "order": number
}

Response:
{
  "_id": string or objectId,  // MongoDB Server-generated ID
  "title": string,
  "order": number,
  "lessons": []  // Empty lessons array
}
```

#### Update Module

```
PUT /api/courses/:courseId/modules/:moduleId

Payload:
{
  "title"?: string,
  "order"?: number
}

Response:
{
  "_id": string or objectId,
  "title": string,
  "order": number,
  "lessons": [
    // Existing lessons remain unchanged
  ]
}
```

#### Delete Module

```
DELETE /api/courses/:courseId/modules/:moduleId

Response:
{
  "success": true
}
```

### Lessons

#### Get Lesson

```
GET /api/courses/:courseId/modules/:moduleId/lessons/:lessonId

Response:
{
  "_id": string or objectId,
  "title": string,
  "videoUrl": string,
  "content": string,
  "duration": string,
  "order": number
}
```

#### Create Lesson

```
POST /api/courses/:courseId/modules/:moduleId/lessons

Payload:
{
  "title": string,
  "videoUrl"?: string,
  "content"?: string,
  "duration"?: string,
  "order": number
}

Response:
{
  "_id": string or objectId,  // MongoDB Server-generated ID
  "title": string,
  "videoUrl": string,
  "content": string,
  "duration": string,
  "order": number
}
```

#### Update Lesson

```
PUT /api/courses/:courseId/modules/:moduleId/lessons/:lessonId

Payload:
{
  "title"?: string,
  "videoUrl"?: string,
  "content"?: string,
  "duration"?: string,
  "order"?: number
}

Response:
{
  "_id": string or objectId,
  "title": string,
  "videoUrl": string,
  "content": string,
  "duration": string,
  "order": number
}
```

#### Delete Lesson

```
DELETE /api/courses/:courseId/modules/:moduleId/lessons/:lessonId

Response:
{
  "success": true
}
```

## Error Responses

All endpoints will return appropriate HTTP status codes:

- 200: Success
- 201: Resource created
- 400: Bad request (invalid data)
- 401: Unauthorized
- 404: Resource not found
- 500: Server error

Error response format:

```json
{
  "error": {
    "message": "Description of the error",
    "code": "ERROR_CODE"
  }
}
```
